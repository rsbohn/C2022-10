<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Fantastic Telegram</title>
  <link rel="icon" type="image/png" href="favicon.png" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" href="https://pyscript.net/alpha/pyscript.css" />
  <script defer src="https://pyscript.net/alpha/pyscript.js"></script>
  <style>
    canvas#display { float:right; background-color:#444; }
  </style>

</head>
<body>
  <canvas id="display" width="320" height="240"></canvas>
  <py-env>
    - paths:
      - lib/board.py
      - lib/displayio.py
  </py-env>
  <py-script>
    import os
    import sys
    print(f">> {sys.version}")
    print(f">> machine={os.uname().machine} version={os.uname().version}")
    canvas = Element("#display")
    import board
    import displayio
    context = board.DISPLAY.getContext('2d')
    w = board.DISPLAY.width//6
    for x in range(6):
      context.fillStyle="rgb(200,0,0)"
      context.fillRect(x*w,10,w-2,18)
      context.fillStyle="rgb(196,64,64)"
      context.fillRect(x*w,30,w-2,20)
    print(f"display is {board.DISPLAY.width}x{board.DISPLAY.height} pixels")

    import random
    from js import setInterval
    from pyodide import create_proxy

    @create_proxy
    def next_message():
        messages=['Red Herring Ltd.','Dewey Chetham and Howe', 'Peleagic Adventures S.A.',
        'red','yellow','green','blue','green with yellow spots', 'derp...derp...DERP!']
        document.getElementById("footer").innerHTML = 'Our sponsor: '+random.choice(messages)

    #id = setInterval(create_proxy(next_message), 500)
    id = setInterval(next_message, 500)

  </py-script>

  <div id="footer">Your Message Here</div>
</body>
</html>
